<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proektche</title>
    <link rel="stylesheet" href="C:\Users\35987\Desktop\Нова папка\style.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.1.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
    <style>
        /* Styles for login and registration forms */
        .form-container {
            display: none; /* Hidden by default */
            max-width: 300px;
            padding: 20px;
            background-color: #f2f2f2;
            margin: 20px auto;
            border-radius: 5px;
        }
        .form-container input[type="email"],
        .form-container input[type="password"],
        .form-container input[type="text"],
        .form-container button {
            width: 100%;
            margin: 10px 0;
            padding: 10px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <div id="page" class="site page-home">
        <header>
            <div class="header-top mobile-hide">
                <div class="container">
                    <div class="wrapper flexitem">
                        <div class="left">
                            <!-- Add content here if necessary -->
                        </div>
                        <div class="right">
                            <!-- Add content here if necessary -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="header-nav">
                <div class="container">
                    <div class="wrapper flexitem">
                        <a href="#" class="trigger desktop-hide"><i class="ri-menu-2-line"></i></a>
                        <div class="left flexitem">
                            <div class="logo"><a href="index.html"><span class="circle">VL</span></a></div>
                            <nav class="mobile-hide">
                                <ul class="flexitem second-links">
                                    <li><a href="index.html">Home</a></li>
                                    <li><a href="page-single.html">Shop</a></li>
                                    
                                </ul>
                            </nav>
                        </div>
                        <div class="right">
                            <ul class="flexitem second-links">
                                <li class="mobile-hide"><a href="#">
                                    <div class="icon-large"><i class="ri-heart-line"></i></div>
                                    <div class="fly-item"><span class="item-number">0</span></div>
                                </a></li>
                                <li><a href="#" class="iscart">
                                    <div class="icon-large">
                                        <i class="ri-shopping-cart-line"></i>
                                        <div class="fly-item"><span class="item-number">0</span></div>
                                    </div>
                                    <div class="icon-text">
                                        <div class="mini-text">Total</div>
                                        <div class="cart-total">$0.00</div>
                                    </div>
                                </a></li>
                                <!-- Button for login/logout -->
                                <li id="loginLink"><a href="#" onclick="toggleLogin()">Login</a></li>
                                <li id="logoutLink" style="display: none;"><a href="#" onclick="logout()">Logout</a></li>
                                <li id="registerLink" style="display: none;"><a href="#" onclick="toggleRegister()">Register</a></li>
                                <li id="addProductLink" style="display: none;"><a href="#" onclick="toggleAddProduct()">Add Product</a></li>
                                <li id="loginStateContainer"></li> <!-- This will display the login state -->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <div class="slider">
                <div class="container">
                    <div class="wrapper">
                        <div class="myslider swiper">
                            <div class="swiper-wrapper">
                                <div class="swiper-slide">
                                    <img src="car1.jpg" alt="Car Part 1">
                                </div>
                                <div class="swiper-slide">
                                    <img src="car2.jpg" alt="Car Part 2">
                                </div>
                                <!-- Add more slides with car parts here -->
                            </div>
                            <!-- Add navigation controls or autoplay if desired -->
                            <div class="swiper-pagination"></div>
                            <div class="swiper-button-prev"></div>
                            <div class="swiper-button-next"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

    </div> 

    <div id="loginFormContainer" class="form-container">
        <h2>Login</h2>
        <form id="loginForm">
            <input type="email" placeholder="Email" required name="email"><br>
            <input type="password" placeholder="Password" required name="password"><br>
            <button type="submit">Login</button>
        </form>
        <p>Don't have an account? <a href="#" onclick="toggleRegister()">Register</a></p>
    </div>

    <div id="registerFormContainer" class="form-container">
        <h2>Register</h2>
        <form id="registerForm">
            <input type="email" placeholder="Email" required name="email"><br>
            <input type="password" placeholder="Password" required name="password"><br>
            <button type="submit">Register</button>
        </form>
        <p>Already have an account? <a href="#" onclick="toggleLogin()">Login</a></p>
    </div>

    <div id="addProductFormContainer" class="form-container" style="display: none;">
        <h2>Add Product</h2>
        <form id="addProductForm">
            <input type="text" placeholder="Product Title" required name="title"><br>
            <input type="text" placeholder="Product Description" required name="description"><br>
            <input type="text" placeholder="Product Image URL" required name="imageURL"><br>
            <input type="number" placeholder="Product Price" required name="price"><br>
            <button type="submit">Add Product</button>
        </form>
    </div>

    <!-- Scripts for login, registration, and logout -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
        document.getElementById('featured-products-btn').addEventListener('click', function(event) {
            event.preventDefault();
            document.getElementById('featured-products').scrollIntoView({ behavior: 'smooth' });
        });
    </script>

    <!-- User Authentication Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID",
            measurementId: "YOUR_MEASUREMENT_ID"
        };

        firebase.initializeApp(firebaseConfig);

        const db = firebase.firestore();

        function toggleLogin() {
            document.getElementById("loginFormContainer").style.display = "block";
            document.getElementById("registerFormContainer").style.display = "none";
            document.getElementById("addProductFormContainer").style.display = "none";
        }

        function toggleRegister() {
            document.getElementById("loginFormContainer").style.display = "none";
            document.getElementById("registerFormContainer").style.display = "block";
            document.getElementById("addProductFormContainer").style.display = "none";
        }

        function toggleAddProduct() {
            document.getElementById("loginFormContainer").style.display = "none";
            document.getElementById("registerFormContainer").style.display = "none";
            document.getElementById("addProductFormContainer").style.display = "block";
        }

        function logout() {
            firebase.auth().signOut().then(() => {
                // Logout successful.
                document.getElementById("logoutLink").style.display = "none";
                document.getElementById("loginLink").style.display = "block";
                document.getElementById("registerLink").style.display = "block";
                document.getElementById("addProductLink").style.display = "none";
                document.getElementById("loginStateContainer").innerHTML = ""; // Clear login state
                localStorage.removeItem('user'); // Remove user info from localStorage
            }).catch((error) => {
                // An error occurred.
                console.error('Error signing out:', error);
            });
        }

        // Function to check authentication state and update UI accordingly
        function checkAuthState() {
            const loginStateContainer = document.getElementById("loginStateContainer");
            const userString = localStorage.getItem('user');
            if (userString) {
                const user = JSON.parse(userString);
                loginStateContainer.innerHTML = `<p>Logged in as: ${user.email}</p>`;
                document.getElementById("logoutLink").style.display = "block";
                document.getElementById("loginLink").style.display = "none";
                document.getElementById("registerLink").style.display = "none";
                document.getElementById("addProductLink").style.display = "block";
            } else {
                const user = firebase.auth().currentUser;
                if (user) {
                    loginStateContainer.innerHTML = `<p>Logged in as: ${user.email}</p>`;
                    document.getElementById("logoutLink").style.display = "block";
                    document.getElementById("loginLink").style.display = "none";
                    document.getElementById("registerLink").style.display = "none";
                    document.getElementById("addProductLink").style.display = "block";
                } else {
                    loginStateContainer.innerHTML = "<p>Not logged in</p>";
                    document.getElementById("logoutLink").style.display = "none";
                    document.getElementById("loginLink").style.display = "block";
                    document.getElementById("registerLink").style.display = "block";
                    document.getElementById("addProductLink").style.display = "none";
                }
            }
        }

        // Subscribe to authentication state changes
        firebase.auth().onAuthStateChanged((user) => {
            if (user) {
                // User is signed in.
                localStorage.setItem('user', JSON.stringify(user)); // Store user info in localStorage
            } else {
                // No user is signed in.
                localStorage.removeItem('user'); // Remove user info from localStorage
            }
            checkAuthState(); // Update UI
        });

        document.getElementById("loginForm").addEventListener("submit", function(event) {
            event.preventDefault(); // Prevent page reload
            const email = document.getElementById("loginForm").elements["email"].value;
            const password = document.getElementById("loginForm").elements["password"].value;
            firebase.auth().signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Login successful.
                    console.log("User logged in:", userCredential.user);
                    document.getElementById("loginFormContainer").style.display = "none"; // Hide the form
                    document.getElementById("loginSuccessMessage").style.display = "block"; // Display success message
                    setTimeout(function() {
                        document.getElementById("loginSuccessMessage").style.display = "none"; // Hide success message after 3 seconds
                    }, 3000);
                })
                .catch((error) => {
                    // An error occurred.
                    console.error("Login error:", error);
                });
        });

        document.getElementById("registerForm").addEventListener("submit", function(event) {
            event.preventDefault(); // Prevent page reload
            const email = document.getElementById("registerForm").elements["email"].value;
            const password = document.getElementById("registerForm").elements["password"].value;
            firebase.auth().createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Registration successful.
                    console.log("User registered:", userCredential.user);
                    document.getElementById("registerFormContainer").style.display = "none"; // Hide the form
                    document.getElementById("registerSuccessMessage").style.display = "block"; // Display success message
                    setTimeout(function() {
                        document.getElementById("registerSuccessMessage").style.display = "none"; // Hide success message after 3 seconds
                    }, 3000);
                })
                .catch((error) => {
                    // An error occurred.
                    console.error("Registration error:", error);
                });
        });


        document.getElementById("addProductForm").addEventListener("submit", function(event) {
            event.preventDefault(); // Prevent page reload
            const title = document.getElementById("addProductForm").elements["title"].value;
            const description = document.getElementById("addProductForm").elements["description"].value;
            const imageURL = document.getElementById("addProductForm").elements["imageURL"].value;
            const price = parseFloat(document.getElementById("addProductForm").elements["price"].value);

            db.collection("products").add({
                title: title,
                description: description,
                imageURL: imageURL,
                price: price
            })
                .then((docRef) => {
                    console.log("Product added with ID: ", docRef.id);
                    document.getElementById("addProductFormContainer").style.display = "none"; // Hide the form
                    document.getElementById("productAddedMessage").style.display = "block"; // Display success message
                    setTimeout(function() {
                        document.getElementById("productAddedMessage").style.display = "none"; // Hide success message after 3 seconds
                    }, 3000);
                })
                .catch((error) => {
                    console.error("Error adding product: ", error);
                });
        });

    </script>
</body>
</html>
